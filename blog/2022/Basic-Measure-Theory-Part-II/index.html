<!DOCTYPE html> <html lang="en"> <head> <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title>Basic Measure Theory Part II | Baiyang Zhang</title> <meta name="author" content="Baiyang Zhang"> <meta name="description" content="A place dedicated to sharing insights and reflections on mathematics, physics, and social sciences. "> <meta name="keywords" content="mathematics, physics, academic-website, portfolio-website"> <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script> <script>window.MathJax={tex:{inlineMath:[["$","$"],["\\(","\\)"]],displayMath:[["$$","$$"],["\\[","\\]"]],tags:"all",tagSide:"right",tagIndent:"0.8em",processEscapes:!0},startup:{ready:function(){console.log("MathJax is ready and configured for automatic equation numbering."),MathJax.startup.defaultReady()}}};</script> <script defer src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script> <link rel="stylesheet" href="/assets/css/bootstrap.min.css?a4b3f509e79c54a512b890d73235ef04"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous"> <link defer rel="stylesheet" href="https://unpkg.com/bootstrap-table@1.22.1/dist/bootstrap-table.min.css"> <link rel="stylesheet" href="/assets/css/academicons.min.css?f0b7046b84e425c55f3463ac249818f5"> <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons"> <link rel="stylesheet" href="/assets/css/jekyll-pygments-themes-github.css?19f3075a2d19613090fe9e16b564e1fe" media="" id="highlight_theme_light"> <link rel="shortcut icon" href="/assets/img/z.png?010ffa0c9cb27051b15dc9ea045f2023"> <link rel="stylesheet" href="/assets/css/main.css?d41d8cd98f00b204e9800998ecf8427e"> <link rel="canonical" href="https://baiyangzhang.github.io/blog/2022/Basic-Measure-Theory-Part-II/"> <link rel="stylesheet" href="/assets/css/jekyll-pygments-themes-native.css?e74e74bf055e5729d44a7d031a5ca6a5" media="none" id="highlight_theme_dark"> <script src="/assets/js/theme.js?96d6b3e1c3604aca8b6134c7afdd5db6"></script> <script src="/assets/js/dark_mode.js?9b17307bb950ffa2e34be0227f53558f"></script> </head> <body class="fixed-top-nav "> <header> <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top"> <div class="container"> <a class="navbar-brand title font-weight-lighter" href="/">Baiyang Zhang</a> <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar top-bar"></span> <span class="icon-bar middle-bar"></span> <span class="icon-bar bottom-bar"></span> </button> <div class="collapse navbar-collapse text-right" id="navbarNav"> <ul class="navbar-nav ml-auto flex-nowrap"> <li class="nav-item "> <a class="nav-link" href="/">about</a> </li> <li class="nav-item active"> <a class="nav-link" href="/blog/">blogs<span class="sr-only">(current)</span></a> </li> <li class="nav-item "> <a class="nav-link" href="/publications/">publications</a> </li> <li class="nav-item "> <a class="nav-link" href="/cv/">cv</a> </li> <li class="nav-item "> <a class="nav-link" href="/teaching/">teaching</a> </li> <li class="toggle-container"> <button id="light-toggle" title="Change theme"> <i class="fas fa-moon"></i> <i class="fas fa-sun"></i> </button> </li> </ul> </div> </div> </nav> <progress id="progress" value="0"> <div class="progress-container"> <span class="progress-bar"></span> </div> </progress> </header> <div class="container mt-5"> <div class="post"> <header class="post-header"> <h1 class="post-title">Basic Measure Theory Part II</h1> <p class="post-meta">October 13, 2022• Baiyang Zhang</p> <p class="post-tags"> <a href="/blog/2022"> <i class="fas fa-calendar fa-sm"></i> 2022 </a>   ·   <a href="/blog/tag/math"> <i class="fas fa-hashtag fa-sm"></i> math</a>   <a href="/blog/tag/functionalanalysis"> <i class="fas fa-hashtag fa-sm"></i> functionalAnalysis</a>   <a href="/blog/tag/distribution"> <i class="fas fa-hashtag fa-sm"></i> distribution</a>   <a href="/blog/tag/measuretheory"> <i class="fas fa-hashtag fa-sm"></i> measureTheory</a>   </p> </header> <article class="post-content"> <div id="markdown-content"> <h1 id="table-of-contents">Table of Contents</h1> <ul> <li><a href="#1-integral-of-measurable-functions">1. Integral of Measurable Functions</a></li> <li><a href="#2-lebesgues-dominated-convergence-theorem">2. Lebesgue’s Dominated Convergence Theorem</a></li> <li> <a href="#3-fubinis-theorem">3. Fubini’s Theorem</a> - <a href="#31-notes">3.1. Notes</a> </li> </ul> <h1 id="1-integral-of-measurable-functions">1. Integral of Measurable Functions</h1> <p>In what follows, we suppose that all function are measurable and defined on the measure space $(X,\mathcal{A},\mu)$.</p> <p>First we define the integral with respect to some measure $\mu$, <strong>Definition</strong> Let $\phi=\sum_{i=1}^n \alpha_{i} 1_ {A_{i}}$ be a simple function; then</p> \[\int \phi \, d\mu=\sum_{i-1}^n \alpha_{i} \mu(A_{i})\] <p>is called the integral of $\phi$ with respect to the measure $\mu$.</p> <p>Recall that function is simple if it is measurable and takes finite number of values, such as the step function defined on $[-1,1]$.</p> <p>The integral of $\mu$ with respect to $\mu$ is finite if and only if the measure of the set where $\phi(x) \neq 0$ is finite. In other words, the measure of the support of $\phi$ must be zero.</p> <p>This definition is quite intuitive, for example, if we want to know how expensive a bag of fruit is, we just count the number of certain kind of fruit (the measure of the set), multiply it by the price (value of the function on this set), and sum over all kinds of the fruits.</p> <p>Whatever properties for integrals certainly hold for integral with respect to measure $\mu$ as well, for example</p> \[\int (\phi_{1}+\phi_{2}) \, d\mu = \int (\phi_{1}) \, d\mu + \int (\phi_{2}) \, d\mu,\] <p>I am too lazy to list all of them here.</p> <p>Now we need to generalize this concept to continuous functions, say $f(x)$. Starting from the simplest case, for now we will assume $f(x)\geq 0$.</p> <p><strong>Definition</strong> Let $f$ be a position measurable function, then the integral of $f$ with respect to the measure of $f$ is</p> \[\int f \, d\mu = \text{sup} \int \psi \, d\mu,\] <p>where the supremum is taken over all positive simple functions $\phi$ such that $\phi&lt;f$ everywhere. This means we are limiting function $f$ from below. $f$ is said to be $\mu$ integrable if its integral is <em>finite</em>.</p> <p>$f$ is only integrable if the the set</p> \[\{ x \mid f(x) = \infty \}\] <p>is $\mu$-negligible. Note that this condition is necessary but not sufficient.</p> <p>Next we give the monotone convergence theorem without proof.</p> <p><strong>Theorem</strong> Monotone convergence theorem. Let $(f_{n})$ be a sequence of positive measurable functions such that</p> \[f_{n}(x) &lt; f_{n+1}(x) \quad \forall n\in \mathbb{N} \quad \forall x\in X\] <p>and</p> \[\forall x\in X \quad \lim_{ n \to \infty } f_{n}(x) = f(x).\] <p>Then</p> \[\lim_{ n \to \infty } \int f_{n} \, d\mu = \int f \, d\mu.\] <p>This theorem is also called the Beppo Levi theorem.</p> <p>The integral of a positive function is only zero if the function is zero almost everywhere.</p> <p>What about functions that are not positive? The solution is rather intuitive: We separate positive and negative parts and treat them both as positive functions. Given a real-valued function $f$, define</p> \[f^+ = \begin{cases} f(x) &amp; f(x) &gt;0 \\ 0 &amp; f(x) &lt; 0 \end{cases}\] <p>and</p> \[f^- = \begin{cases} -f(x) &amp; f(x) &lt; 0 \\ 0 &amp; f(x) &gt; 0 \end{cases}\] <p>where both $f^{\pm}$ are positive functions. $f$ is said to be $\mu$-integrable if both $f^+$ and $f^-$ are integrable, and the integral of $f$ is</p> \[\int f \, d\mu = \int f^+ \, d\mu - \int f^- \, d\mu.\] <p>Quite intuitive, isn’t it? For complex-valued functions, we just need to treat its real and imaginary part as real functions, everything follows from that of a real-valued function.</p> <p>The interesting thing is that, as far as integral is concerned, we can neglect the sets with zero measure. Traditionally, any function has an operation called evaluation which is defined pointwise, e.g. given a real-valued function $f(x)$, we can evaluate it at point $x = x_{0}$, which gives us a real number. However, a point has measure zero, so, again, as far as integral is concerned, evaluation is not needed. You could perfectly come up with a function which can’t be evaluated at some point, for instance a function at $x=x_{0}$ might not be defined, but still the function could be integrable. To say a function is $\mu$-integrable just means that $f^{+,-}$ are $\mu$-integrable respectively.</p> <p>Two functions $f,g$ has the same integral if they equal to each other almost everywhere, and this is a equivalence relation.</p> <p>The sum of a convergent series is nothing but an integral on the counting measure. Recall that give an finite set $S$ and $A \subseteq S$ then the <em>cardinality</em> of $A$ is the number of elements in $A$, sometimes denoted by $\text{Num}(A)$. Then $\text{Num}$ as a measure is called the counting measure.</p> <p><strong>Theorem</strong> The set of all $\mu$-integral functions form a vector space, it is denoted by $\mathcal{L}_{\mu}^1$.</p> <p>The superscript $1$ denotes the power of the function. $\mathcal{L}^2_ {\mu}$ would mean the square of the functions are integrable. This theorem is easy to verify since addition, subtraction and number-production of an element in $\mathcal{L}_ {\mu}^1$ is still in $\mathcal{L}_{\mu}^1$.</p> <p><strong>Theorem</strong> If $f$ is $\mu$-integrable, so is $\lvert f \rvert$, and we have</p> \[\left\lvert \int f \, d\mu \right\rvert \leq \int \left\lvert f \right\rvert \, d\mu.\] <p>Recall that for $f$ to be $\mu$-integrable, by definition both $f^+$ and $f^-$ are required to be finite.</p> <p>A measurable function is $\mu$-integrable if and only if $\left\lvert f \right\rvert$ is $\mu$-integrable.</p> <p>If a function is Riemann integrable on $[a,b]$ then it is also Lebesgue integrable on $[a,b]$, and the two results agree. Indeed, if $f$ is Riemann integrable then we can always find two limiting step functions sandwiching $f$ from above and below,</p> \[g_{\epsilon} \leq f \leq h_{\epsilon}\] <p>where $g,h _{\epsilon}$ are step functions and</p> \[\int (g_{\epsilon} - h_{\epsilon}) \, d\mu &lt; \epsilon.\] <p>Step function are always Lebesgue integrable, plus the function is bounded, thus $f$ is also Lebesgue integrable. To summarize we have</p> \[\text{Riemann integrable} \implies \text{Lebesgue integrable}.\] <p>The inverse, however, is not necessarily true. A famous example is the Dirichlet function, defined on $[0,1]$ and</p> \[f(x) = \begin{cases} 0 &amp; \text{if x is rational}, \\ 1 &amp; \text{if x is irrational}. \end{cases}\] <p>$f=1$ almost everywhere, since the Lebesgue measure of the rational numbers in $[0,1]$ is $0$. Recall that $f=1$ almost everywhere means that the set on which $f=0$ has measure zero, and this is true since $f(ratioanl)=0$ and rational numbers are countable, plus each point has zero measure, and countable many zeros are still zero. However, it is impossible to find two step function to sandwich Dirichlet function, thus it is not Riemann integrable.</p> <p>The class of Riemann integrable functions is quite restricted. Of course a continuous, bounded function on a finite interval $[a,b]$ is Riemann integrable, but being Riemann integrable actually requires less – any bounded function on $[a,b]$ which is continuous <em>almost everywhere</em> is Riemann integral. For example, the $\theta(x)$ function defined on $[-2,2]$ is continuous except at $x=0$, so it is continuous almost everywhere, thus Riemann integrable.</p> <p>E.g. The function</p> \[f: x \mapsto \frac{\sin x}{x}\] <p>is not integrable with respect to the Lebesgue measure on $\mathbb{R}^+$ since $\left\lvert f \right\rvert$ is not integrable on $\mathbb{R}^+$.</p> <p>We know that $\frac{\sin x}{x}$ is conditionally convergent, such notion does not exist in Lebesgue theory of integral.</p> <h1 id="2-lebesgues-dominated-convergence-theorem">2. Lebesgue’s Dominated Convergence Theorem</h1> <p>According to my mathematical friends, the dominated convergence theorem is one of the most important results of Lebesgue’s integration theorem. It tells us how to deal with the limit of a sequence of functions under the integral sign, and it might be trickier than some physicist might have thought.</p> <p>To understand Lebesgue’s theorem we need the following lemma.</p> <p><strong>Fatou’s lemma.</strong> Let $(f_{n})$ be a sequence of functions which are nonnegative and measurable on $(X,\mathcal{A},\mu)$. Then</p> \[\boxed{ \int \lim_{ n \to \infty } \text{inf } f_{n} \, d\mu \leq \lim_{ n \to \infty } \text{inf } \int f_{n} \, d\mu . }\] <p>The equal sign is not surprising at all, what usually surprises people is the less than sign, for Fatou’s lemma tells us that if you first take pointwise limit of a sequence of functions, then integrate the limit, what you get might be less than integrate each function in the sequence and take the limit later.</p> <p>To have an intuitive feeling about the lemma, consider an example where the less-than-relation holds. Consider a sequence of functions $(f_{n}),\,n\in \mathbb{N}$ defined on $\mathbb{R}$ with Borel $\sigma$-set,</p> \[f_{n}(x) = \begin{cases} \frac{1}{n} &amp; x\in (0,n), \\ 0 &amp; \text{otherwise}. \end{cases}\] <p>This sequence uniformly converges to zero function on $\mathbb{R}$, Thus</p> \[\int \lim_{ n \to \infty } \text{ inf } f_{n} \, d\mu = \int_{0}^n \lim_{ n \to \infty } \text{ inf }\frac{1}{n} \, d\mu = \int 0 \, d\mu = 0,\] <p>On the other hand, the integral of $f_{n}$ on $\mathbb{R}$ is always $1$, thus</p> \[\lim_{ n \to \infty } \text{ inf } \int f_{n} \, dx = \lim_{ n \to \infty } \text{ inf } \int_{0}^{n} \frac{1}{n} \, d\mu = \lim_{ n \to \infty } \text{ inf } 1 = 1,\] <p>and $0&lt;1$.</p> <p>The integral of a function not only depends on its pointwise value, but also the support. In this context, taking the pointwise limit of a function might give you different results because the limit procedure might give you some function value which is qualitative different, for example $\frac{1}{n}$ is qualitatively different from $0$ because there is a number that multiplies $\frac{1}{n}$ could give you $1$ but there is no such number for $0$. By taking the limit under the integral sign, we might miss the information about the support of the function, while taking the limit of the integral will not. That’s why these two results could be different.</p> <p>The condition that $(f_{n})$ being non-negative is also important, it is necessary for the $\leq$ sign to hold.</p> <p>To prove the lemma, define</p> \[g_{n} := \underset{k\geq n}{\text{ inf }} f_{k},\] <p>then $g_{n}$ is 1)measurable since $f_{n}$’s are measurable, 2) non-decreasing and 3) $g_{n} \leq f_{n}$ by construction. Properties 2) and 3) are pointwise. We have</p> \[\lim_{ n \to \infty } \int g_{n} \, d\mu = \int \lim_{ n \to \infty } \text{ inf } f_{n} \, d\mu,\] <p>Where we have interchanged the order of $\lim_{ n \to \infty }$ and $\int \, d\mu$. This is allowed since both sides are $&lt;\infty$. Since $g_{n} \leq f_{n}$, we have</p> \[\int g_{n} \, d\mu \leq \int f_{n} \, d\mu \implies \lim_{ n \to \infty } \int g_{n} \, d\mu \leq \lim_{ n \to \infty } \int f_{n} \, d\mu = \lim_{ n \to \infty } \text{ inf } \int f_{n} \, d\mu.\] <p>The lemma follows.</p> <p><strong>Theorem</strong> Lebesgue’s dominated convergence theorem. Let $(X,\mathcal{A},\mu)$ be a measure space, let $(f_{n})$ be a sequence of measurable functions from $X$ to $\mathbb{R}$ or $\mathbb{C}$ that converge to $f$ almost everywhere. If there exists $\mu$-integral function $g$ such that, for all positive integers $n$, $\left\lvert f_{n} \right\rvert \leq g$, then</p> \[\lim_{ n \to \infty } \int f_{n} \, d\mu = \int f \, d\mu.\] <p>Note the position of the limit, it is in front of the integral not under it, so information about the support of the function is already included in the integral.</p> <p>$f$ is measurable since $g$ is and</p> \[\left\lvert f_{n} \right\rvert \leq g \implies \left\lvert f \right\rvert \leq g.\] <p>For the same reason $f$ is integrable. Since $\left\lvert f_{n} - f \right\rvert \leq 2g$, the sequence of functions</p> \[2g - \left\lvert f_{n}-f \right\rvert\] <p>are non-negative. Then Fatou’s lemma applies and yields</p> \[\int \lim_{ n \to \infty } \text{ inf } (2g-\left\lvert f_{n}-f \right\rvert ) \, d\mu \leq \lim_{ n \to \infty } \text{ inf } \int (2g-\left\lvert f_{n}-f \right\rvert ) \, d\mu.\] <p>Since $\lim \text{ inf } f_{n} = f$, we have</p> \[2\int g \, d\mu \leq 2 \int g \, d\mu - \lim_{ n \to \infty } \text{ inf }\int \left\lvert f_{n}-f \right\rvert \, d\mu.\] <p>Since $\int g \, d\mu &lt; \infty$, we can subtract it on both sides,</p> \[\lim_{ n \to \infty } \text{ inf }\int \left\lvert f_{n}-f \right\rvert \, d\mu \leq 0,\] <p>however the integral of a non-negative must be non-negative, thus</p> \[\lim_{ n \to \infty } \text{ inf }\int \left\lvert f_{n}-f \right\rvert \, d\mu = 0 \implies \boxed{ \lim_{ n \to \infty } \int f_{n} \, d\mu = \int f \, d\mu }.\] <p>The $n$-independent function $g$ is said to <em>dominate</em> the sequence $(f_{n})$. Roughly speaking it provides some kind of an upper limit so the sequence of functions behave nicely under limiting procedure.</p> <p>There indeed exists functions that can not be dominated by other functions, such as our old friend $f_{n}: x \mapsto \frac{1}{n} 1_ {[0,n]}$. To see that $f: x \mapsto \frac{1}{n} 1_ {[0,n]}$ has no dominating function $g(x)$ we notice that the support of the function goes to $\infty$ as $n \to \infty$. Of course you can find a function so that $\left\lvert f_{n} \right\rvert \leq g$ for all $n$, such as $g = 1$ on $\mathbb{R}$, but then $g$ wouldn’t be measurable. Thus dominated convergence theorem doesn’t apply here. The theorem applies to function $f: x\mapsto x^n$ defined on $[0,1]$, since it is dominated by $1_ {[0,1]}$. The takeaway is that, the support of a function matters!</p> <p>In Riemann’s integral theory there is something called the improper integral, such as infinite integral, or when the integrand is discontinuous. They generalize Riemann’s integral theory. There is no such thing in Lebesgue’s integral theory.</p> <p><strong>Example</strong> Consider the sequence of functions defined on $[0,1]$,</p> \[f_{n}: x \mapsto \frac{n^{3/2}x}{1+n^2 x^2}\] <p>which tends to zero at large $n$. However, the convergence is not uniform since no matter how large $n$ is, there always exists a very small $x \sim \frac{1}{n}$ where $f_{n} \sim \frac{\sqrt{ n }}{2}$. Thus it is not clear that its Riemann integral is zero or not,</p> \[\lim_{ n \to \infty } \int_{0}^1 f_{n} \, dx \overset{?}{=} 0.\] <p>Here is where the dominated convergence theorem come to aid. We can find a measurable function $\frac{~1}{\sqrt{ x }}$ that dominates $f_{n}$, thus</p> \[\lim_{ n \to \infty } \int_{0}^1 \, f_{n}dx = \int_{0}^{1} \lim_{ n \to \infty } f_{n} \, dx =0.\] <p>The following results are important to study a function defined by an integral. Since summation is just a discrete form of integral, the results apply equally to functions defined by a series.</p> <p><strong>Theorem</strong> Let $(X,\mathcal{A},\mu)$ be a measure space and $(Y,d)$ be a metric space; if $f$ is a function defined on $X \times Y$ such that</p> <ol> <li>for all $y \in Y$, $x \mapsto f(x,y)$ as a function of $x$ is measurable,</li> <li>for all $x\in X$, $y \mapsto f(x,y)$ as a function of $y$ is continuous at $y_{0}$,</li> <li>there exists an integrable function $g$ on $X \times Y$ such that for all $x\in X$ and $y \in Y$, $\left\lvert f(x,y) \right\rvert\leq g$.</li> </ol> <p>Then, for all $y\in Y$, $x \mapsto f(x,y)$ is integrable, and the function defined by integral</p> \[F: y \to \int f(x,y) \, d\mu\] <p>is continuous at $y=y_{0}$.</p> <p>The proof can be found in textbooks. The proof of course uses the Lebesgue’s dominance convergence theorem.</p> <p>There is a similar theorem, <strong>Theorem</strong> let $(X,\mathcal{A},\mu)$ be a measure space and $\mathbb{I}$ an open interval of $\mathbb{R}$, if $f$ is a function defined on $X \times \mathbb{I}$ and satisfies</p> <ol> <li>$x \mapsto f(x,y)$ is integrable for all $x\in X$,</li> <li>$y\mapsto f(x,y)$ is differentiable for $x$ almost everywhere,</li> <li>there exists a function defined on $X \times \mathbb{I}$ that dominates $f(x,y)$,</li> </ol> <p>then for all $y \in \mathbb{I}$, the function</p> \[x \mapsto \frac{d}{dy} f(x,y)\] <p>is integrable, and the function</p> \[F: y \mapsto \int f(x,y) \, dy\] <p>is differentiable.</p> <p>As an example, let’s look at the Bessel function of the first kind, defined by</p> \[J_{n}(x) = \frac{1}{\pi} \int_{0}^{\pi} \cos(n\theta-x\sin \theta) \, d\theta\] <p>Since $x \mapsto \cos(n\theta-x\sin \theta)$ is continuous with absolute value $\leq 1$ (being dominated by a measurable function), $J_{n}$ is continuous. It is also differentiable, hence $J_{n}$ is also differentiable. It is actually infinitely differentiable, it is the solution of equation</p> \[y'' + \frac{1}{x} y' +\left( 1-\frac{n^2}{x^2} \right)y = 0.\] <p>Within the framework of Lebesgue’s integral theory, differentiation under the integral sign is not permitted. Consider the function $F$ defined by</p> \[F(x) = \int_{-\infty}^{\infty} \frac{e^{ixy}}{1+y^2} \, dy,\] <p>the integrand is bounded by $\frac{1}{1+y^2}$, which is integrable on $\mathbb{R}$. Follow the same arguing we see that $F(x)$ is continuous. If we differentiate under the integral sign, we obtain</p> \[F(x) = \int_{-\infty}^{\infty} \frac{iy e^{ixy}}{1+y^2} \, dy,\] <p>which is bounded by</p> \[\frac{y}{1+y^2}\] <p>which is not measurable, thus the theorem we introduced before doesn’t apply, and $F’(x)$ can not be expressed by the above integral. In fact the original integral can be calculated using the residue theorem yielding</p> \[F(x) = \pi e^{-\left\lvert x \right\rvert }\] <p>and the absolute value is where the problem arises. This function is not differentiable at $x=0$ but infinitely differentiable at the complement of the origin.</p> <h1 id="3-fubinis-theorem">3. Fubini’s Theorem</h1> <p>We often meet double integrals, that is integrals of measurable functions defined on some product space $X \times Y$ where both $X$ and $Y$ are measurable spaces, $(X,\mathcal{A},\mu)$ and $(Y, \mathcal{B},\nu)$. The product $\sigma$-algebra is denoted $\mathcal{A} \otimes \mathcal{B}$ and product measure $\mu \otimes \nu$.</p> <p>Let $E$ be a subset of $X \times Y$, the sets</p> \[E_{x} := \{ y \mid (x,y) \in E \} \quad \text{ and }\quad E^y := \{ x \mid (x,y)\in E \}\] <p>are called the $x$-section and $y$-section of $E$. It is called a section since, given a map $\pi_{x}: (x,y)\mapsto x$, and regard $E\xrightarrow{ \pi_{x} } x$ as a fiber bundle then $E_{x}$ is just the section of $\pi_{x}$. Similar for $E_{y}$.</p> <p>Without proof, we claim that measurable sets have measurable sections. This should be intuitive since the section is a subset of the product space, and the $\sigma$-algebra of the product space still applies to the subset. I am not sure why in $E_{x}$, $x$ appears in the subscript while in $E^y$, $y$ appears in the superscript.</p> <p>To put the above claim in mathematical language, we have</p> <p><strong>Theorem</strong> Let $(X \times Y, \mathcal{A} \otimes \mathcal{B})$ be the product measurable space, if $E$ belong to $X \times Y$ then</p> \[\text{for all } x \in X, \quad y \in Y, \quad \text{ we have } E^{y} \in \mathcal{A} \text{ and } E_{x} \in \mathcal{B}.\] <p>As a corollary, given a function $f$ on $X \times Y$, for all $x \in X$, the function $f_{x}(y):= y \mapsto f(x,y)$ is measurable, as it is nothing but the $x$-section.</p> <p>We distinguish two closely related concepts, namely <em>finite measure</em> and *$\sigma$-finite measure, the extra $\sigma$- makes all the difference.</p> <p>given a measure space $(X,\mathcal{A},\mu)$,</p> <ul> <li>the measure is called finite measure, if the measure of the entire $X$ is finite, and a subset $A \subset X$ is of finite measure if $\mu(A) &lt; \infty$. This is quite self-explanatory. On the other hand,</li> <li>The measure is called $\sigma$-finite if $X$ is a union of countable (could be infinite) subsets, each subset has a finite measure. A subset of $X$ is said to have finite $\sigma$-measure if it is countable union of measurable sets with finite measure.</li> </ul> <p>$\sigma$-finite is a weaker condition than finite measure. For example, $\mathbb{R}$ under the Lebesgue is NOT a finite measure since $\mu(\mathbb{R}) = \infty$, however it is $\sigma$-finite, since we can separate $\mathbb{R}$ into countable intervals, each with finite $\sigma$-measure.</p> <p>The next theorem deals with the order of double integrals, and it makes use of the concept of $\sigma$-finiteness.</p> <p><strong>Theorem</strong> Let $(X,\mathcal{A},\mu)$ and $(Y,\mathcal{B},\nu)$ be two measure spaces, the measure $\mu$ and $\nu$ being $\sigma$-finite. If $E$ belong to the $\sigma$-algebra $\mathcal{A} \otimes \mathcal{B}$, then, for all $x \in X$ and $y \in Y$,</p> \[\int \nu(E_{x}) \, d\mu(x) = \int \mu(E^y) \, d\nu(y).\] <p>This theorem is important but the proof is not (for physicists at least) so we will skip it, interested readers can refer to textbooks on measure theory.</p> <p><strong>Fubini’s theorem.</strong> Let $(X,\mathcal{A},\mu)$ and $(Y,\mathcal{B},\nu)$ be two measure spaces, measure $\mu,\nu$ being $\sigma$-finite. Let $f$ be a $\mu \otimes \nu$-integrable function defined on $X \times Y$. The function</p> \[x \mapsto \int f(x,y) \, d\nu(y)\] <p>as a function of $x$ is $\mu$-integrable. Namely, we can first perform the integral over $y$, the remaining function of $x$ is $\mu$-integrable. Similarly, we can perform the integral over $x$ first and the remaining function of $y$ is still integrable, namely the function</p> \[y \mapsto \int f(x,y) \, d\mu(x)\] <p>is $\nu$-integrable. The order of integral is exchangeable,</p> \[\begin{align} \int f \, d\mu(x)\otimes \nu &amp; = \int \left[ \int f(x,y) \, d\nu(y) \right] \, \, d\mu(x) \\ &amp; = \int \left[ \int f(x,y) \, d\mu(x) \right] \, d\nu(y) . \end{align}\] <p>The proof is also skipped here, we only mentioned that the definition of Lebesgue integral, namely liming the real integral of a function by the infimum of simple functions, is used, as well as the monotone convergence theorem.</p> <p>Since the two measures $\mu,\nu$ play a symmetric role, we can also write</p> \[\int f \, d\mu \otimes \nu = \int f \, d\mu(x) d\nu(y)\] <p>If the function is $\mu \otimes \nu$-integrable, Fubini’s theorem is often used to justify interchanging the order of the integrals.</p> <p>To apply Fubini’s theorem, it is essential to verify that the function $f$ is $\mu \otimes \nu$ integrable, that is, $f$ has to be measurable, and $\left\lvert f \right\rvert$ is also measurable, which means one of the three following things,</p> <ul> <li>$\int \left\lvert f \right\rvert \, d\mu \otimes \nu &lt; \infty,$</li> <li>$\int d\mu(x) \, \int d\nu(y) \, \left\lvert f(x,y) \right\rvert &lt; \infty,$</li> <li>$\int d\nu(y)\, \int d\mu(x) \, \left\lvert f(x,y) \right\rvert &lt; \infty.$</li> </ul> <p>Fubini’s theorem for positive functions is also known as the <strong>Fubini-Tonelli</strong> theorem.</p> <p>Since summation is just integral with counting measure, we could replace one or both of the integral signs as summation. Then Fubini’s theorem states that we can interchange the order of summation (or of summation and integral) in the case of absolutely convergent double series (or summation of integrals, etc.). An counter example is</p> \[\int_{-\infty}^{\infty} e^{ -x^2-\lambda x^4 } \, d = \int_{-\infty}^{\infty} e^{ -x^2 } e^{ -\lambda x^4 } \, dx = \int_{-\infty}^{\infty} e^{ -x^2 }\sum_{n=0}^\infty \frac{(-\lambda)^n}{n!}x^{-4n} \, dx,\] <p>the radius of convergence of the summation is $\infty$. However if we interchange the order of integral and summation, namely move the summation in from of the integral sign, we have</p> \[\sum_{n=0}^\infty \frac{(-\lambda)^n}{n!}\int_{-\infty}^{\infty} e^{ -x^2 }x^{-4n} \, dx\] <p>where the integral can be performed with the help of Gamma function, then after some calculation we have a divergent power series, thus not measurable. Then Fubini’s theorem does not apply to this situation.</p> <p>When applicable, Fubini’s theorem can be used to integral a function defined by another integral. However, it is possible that interchanging the order of integrals gives two different results. For example, consider function</p> \[f: x \mapsto \frac{x^2-y^2}{(x^2+y^2)^2}\] <p>defined on $[0,1]\times[0,1]\backslash (0,0)$ where $(0,0)$ is the origin where the function blows up, and $A\backslash B$ means $A$ minus $B$. Since $(0,0)$ is a point and points have measure zero, it is not necessary to define $f$ for $(x,y) = (0,0)$. Since</p> \[\frac{d}{dx} \frac{-x}{x^2 + y^2} = \frac{x^2-y^2}{(x^2+y^2)^2},\] <p>we have</p> \[\int_{0}^{1} dy \, \int_{0}^{1} dx\, f(x,y) = - \frac{\pi}{4},\] <p>however if we interchange the order of integral, we have</p> \[\int_{0}^{1} dx \, \int_{0}^{1} dy\, f(x,y) = \frac{\pi}{4},\] <p>note the extra minus sign. Hence $f$ is not integrable. As a matter of fact we have</p> \[\int_{0}^{1} dy \int_{0}^{1} dx \, \left\lvert \frac{x^2-y^2}{(x^2+y^2)^2} \right\rvert = \infty.\] <p>If interchanging the order of the repeated integrals gives identical results, that doesn’t prove that Fubini’s theorem applies, for the integral of the absolute value of the function might not be convergent. Consider, for example, function $f$ defined on $R_{+}^2$, $f:(x,y)\mapsto \sin(x^2+y^2)$. Expanding $\sin(x^2+y^2)$ and taking into consideration the Fresnel’s integral</p> \[\int_{0}^{\infty} e^{ ix^2 } \, dx =\sqrt{ 2\pi }(1+i) / 4\] <p>we have</p> \[\int_{0}^{\infty} dy\, \int_{0}^{\infty} dx \, \sin(x^2+y^2) = \int_{0}^{\infty} dx\, \int_{0}^{\infty} dy \, \sin(x^2+y^2) = \frac{\pi}{4}.\] <p>However, $\sin(x^2+y^2)$ is not measurable on $R_{+}^2$ since the integral of its absolute value is divergent,</p> \[\int_{0}^{\infty} dy \, \int_{0}^{\infty} dx \,\left\lvert \sin(x^2+y^2) \right\rvert =\infty,\] <p>this result if readily obtained using the change of variables: $x = \rho \cos \theta, y = \rho \sin \theta$.</p> <p>Note that the for Fubini’s theorem to be valid, the measure $\mu,\nu$ have to be $\sigma$-finite. The most popular example for a non-sigma-finite measure maybe the counting measure on $\mathbb{R}$. The counting measure gives the cardinal (number of elements) of a set, and the set of all the real numbers is uncountable. On the contrary, the set of rational numbers $\mathbb{Q}$ in countable.</p> <p>Consider a function $f$ defined on $[0,1]\times[o,1]$ by</p> \[f(x,y) = \begin{cases} 1, &amp; x=y, \\ 0, &amp; \text{otherwise.} \end{cases}\] <p>Here comes the interesting part: on the $y$-axis we adopt the counting measure $\nu(y)$ instead of the familiar Lebesgue measure, while on the $x$-axis we still use the Lebesgue measure $\mu(x)$. Recall that $\nu(\text{point}) = 1$, we have</p> \[\int_{0}^{1} f(x,y) \, d\nu(y) = 1,\] <p>if we integrate with respect to $y$ first then to $x$, we have</p> \[\int_{0}^{1} d\mu(x) \, \int_{0}^{1} d\nu(y) \, f(x,y) = \int_{0}^{1} d\mu(x) \,1 = 1.\] <p>But if we integrate with respect to $x$ first, we get</p> \[\int_{0}^{1} d\nu(y) \,\int_{0}^{1} d\mu(x) \, f(x,y) = \int_{0}^{1} d\mu(x) \, 0 = 0,\] <p>Apparently the Fubini’s theorem doesn’t apply here.</p> <p>The convolution of two real-valued integrable (with respect to Lebesgue measure) functions $f,g$ is defined as</p> \[f\ast g (x) = \int_{-\infty}^{\infty} f(x-y)g(y) \, dy ,\] <p>which is also integrable, since</p> \[\int \left\lvert f\ast g \right\rvert \, dm \leq \int \left\lvert f \right\rvert \, dm \int \left\lvert g \right\rvert \, dm,\] <p>where $dm$ is whatever measure used for the integral.</p> <p>Next we give an example where the interchange of integral and summation makes sense. Consider the integral</p> \[\int_{0}^{\infty} \frac{\sin x}{e^{ x }-1} \, dx\] <p>which is convergent. We may write</p> \[\begin{align} \int_{0}^{\infty} \frac{\sin x}{e^{ x }-1} \, dx &amp; = \int_{0}^{\infty} \frac{\sin x}{e^{ x }(1-e^{-x})} \, dx \\ &amp;= \int_{0}^{\infty} dx \, \sum_{k=1}^\infty e^{ -kx }\sin x \\ &amp;= \sum_{k=1}^\infty \int_{0}^{\infty} dx \, e^{ -kx }\sin x, \end{align}\] <p>where we have used</p> \[(1-e^{ -x })^{-1} = \sum_{n=0}^\infty e^{ -(n+1)x }.\] <p>The interchange of the sign $\sum$ and $\int$ is justified, since the Fubini theorem applies to the function $(x,k)\mapsto e^{ -kx }\sin x$, which is due to the fact that</p> \[\int e^{ -kx } \sin x \, dx &lt;\infty\] <p>the exponential suppression makes the integrand Lebesgue integrable. By the end of the day we get</p> \[\int_{0}^{\infty} \frac{\sin x}{e^{ x }-1} \, dx = \sum_{k=1}^\infty \frac{1}{1+k^2}.\] <p>The right hand side of the above expression can be calculated by the residual theorem. Finally, we have</p> \[\int_{0}^{\infty} \frac{\sin x}{e^{ x }-1} \, dx = \frac{1}{2} (\pi \coth \pi-1).\] <p>As we can see, Lebesgue’s theory is kind of a generalization of Riemann’s theory in term of the concept of measure. Lebesgue’s theorem can be stated as follows,</p> <p><strong>Theorem</strong> A function defined on a <em>bounded</em> interval $[a,b]$ is Riemann integrable if and only if it is bounded and continuous <em>almost everywhere</em>.</p> <h3 id="31-notes">3.1. Notes</h3> <p>Given a map $f$ from a set $X$ into a set $Y$, the preimage of a $\sigma$-algebra in $Y$ is a $\sigma$-algebra in $X$ but the inverse is not necessary true. However, if $\mathcal{A}$ is a $\sigma$-algebra in $X$, the set of all the subsets of $Y$ such that their preimage is in $\mathcal{A}$ forms as $\sigma$-algebra and is called the induced $\sigma$-algebra.</p> <p>Let $(a_{n})$ be a sequence of $\mathbb{R}$ and for any $k \in \mathbb{N}$, define</p> \[b_{k} = \text{inf }(a_{k},a_{k+1},\dots) = \text{inf }\{ a_{n} \mid n\geq k \}\] <p>and</p> \[B_{k} = \text{sup }(a_{k},a_{k+1},\dots) = \text{sup }\{ a_{n} \mid n\geq k \}\] <p>then</p> \[\lim_{ n \to \infty } \text{inf }a_{n} = \text{sup } (b_{1},b_{2},\dots)\] <p>and</p> \[\lim_{ n \to \infty } \text{sup }a_{n} = \text{inf }(B_{1},B_{2},\dots).\] <p>lim inf is called the lower limit of the sequence $a_{n}$, respectively lim sup is called the upper limit.</p> <p>As the last part of the note, let’s briefly summarize the integration theory for function defined on a finite interval $[a,b]$.</p> <p>By a partition $\pi$ of a closed interval $[a,b]$ we mean the <em>finite</em> set</p> \[\pi = \{ a=x_{0},x_{1},\dots,x_{m-1}, x_{m}=b\}\] <p>where $x_{0}&lt;x_{1}&lt;\dots &lt;x_{m}$. In other words, a partition is a way to divide an interval into finite disjoint subsets without neglecting anything.</p> <p>The norm of the partition is</p> \[\delta(\pi) = \text{sup }(x_{k} - x_{k-1}).\] <p>Given a continuous function on $[a,b]$, the Cauchy sum associated to $f$ and $\pi$ is defined as</p> \[S_{\pi}(f) := \sum_{k=1}^m f(x_{k-1})(x_{k}-x_{k-1}).\] <p>$f$ being continuous, it can be shown that as long as the norm of the partition is sufficiently small, the difference between Riemann integral and Cauchy sum is arbitrarily small. To be more specific, if $(\pi_{n})$ is a sequence of partitions of $[a,b]$ such that $\lim_{ n \to \infty }\delta(\pi_{n})=0$, then $(S_{\pi_{n}}(f))$ is a Cauchy sequence. Cauchy sequence is a sequence whose elements become arbitrarily close to each other as the sequence progresses. This limit is called the Cauchy integral of $f$ on $[a,b]$, denoted by</p> \[\int_{a}^{b} f(x) \, dx .\] <p>The class of Cauchy integrable functions is much larger than the class of continuous functions.</p> <p>Any finite linear combination of characteristic functions of open bounded intervals of $\mathbb{R}$ is called a step function, and the step functions on $\mathbb{R}$ form a vector space. Given a step function $s(x)$, the mapping</p> \[s \mapsto \left\lVert s \right\rVert =\text{sup }s(x) \text{ for all } x\in\mathbb{R}\] <p>is called the norm of the uniform convergence. If a sequence of step functions converges uniformly to a function $f$, this function is said to be <em>regulated</em>. Obviously regulated function has Cauchy integrals.</p> <p>A regulated function can be discontinuous at countable number of points.</p> <p>A function is Cauchy integrable if and only if it is regulated. Riemann integrability applies to a slightly larger class of functions. Recall that a function $f$ defined on $[a,b]$ is said to be Riemann integrable if, for all positive $\epsilon$, there exists two step function $g_{\epsilon},h_{\epsilon}$ such that</p> \[g_{\epsilon} \leq f \leq h_{\epsilon}\] <p>and</p> \[\left\lvert \int h_{\epsilon} \, dx - \int g_{\epsilon} \, dx \right\rvert &lt;\epsilon.\] <p>If a function is bounded and Cauchy integrable, then it is also Riemann integrable.</p> </div> </article> <br> <hr> <br> <ul class="list-disc pl-8"></ul> <h2 class="text-3xl font-semibold mb-4 mt-12">Enjoy Reading This Article?</h2> <p class="mb-2">Here are some more articles you might like to read next:</p> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/blog/2022/displaying-external-posts-on-your-al-folio-blog/">Displaying External Posts on Your al-folio Blog</a> </li> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/blog/2024/Constructing-a-Finite-Tension-Domain-Wall-in-4D-Part-III/">Constructing a Finite Tension Domain Wall in 4D Part III</a> </li> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/blog/2024/Thoughts-on-Entropy/">Some Thoughts on Entropy</a> </li> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/blog/2024/Tsallis-Statistics-in-Logistic-Regression/">Tsallis Statistics in Logistic Regression</a> </li> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/blog/2024/Calculating-States-Using-Diagrams/">Calculating States Using Diagrams</a> </li> </div> </div> <footer class="fixed-bottom"> <div class="container mt-0"> © Copyright 2024 Baiyang Zhang. Powered by <a href="https://jekyllrb.com/" target="_blank" rel="external nofollow noopener">Jekyll</a> with <a href="https://github.com/alshedivat/al-folio" rel="external nofollow noopener" target="_blank">al-folio</a> theme. Hosted by <a href="https://pages.github.com/" target="_blank" rel="external nofollow noopener">GitHub Pages</a>. Last updated: December 16, 2024. </div> </footer> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> <script src="/assets/js/bootstrap.bundle.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/masonry-layout@4.2.2/dist/masonry.pkgd.min.js" integrity="sha256-Nn1q/fx0H7SNLZMQ5Hw5JLaTRZp0yILA/FRexe19VdI=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/imagesloaded@4/imagesloaded.pkgd.min.js"></script> <script defer src="/assets/js/masonry.js" type="text/javascript"></script> <script defer src="https://cdn.jsdelivr.net/npm/medium-zoom@1.0.8/dist/medium-zoom.min.js" integrity="sha256-7PhEpEWEW0XXQ0k6kQrPKwuoIomz8R8IYyuU1Qew4P8=" crossorigin="anonymous"></script> <script defer src="/assets/js/zoom.js?7b30caa5023af4af8408a472dc4e1ebb"></script> <script defer src="https://unpkg.com/bootstrap-table@1.22.1/dist/bootstrap-table.min.js"></script> <script src="/assets/js/no_defer.js?d633890033921b33e0ceb13d22340a9c"></script> <script defer src="/assets/js/common.js?acdb9690d7641b2f8d40529018c71a01"></script> <script defer src="/assets/js/copy_code.js?c9d9dd48933de3831b3ee5ec9c209cac" type="text/javascript"></script> <script async src="https://d1bxh8uas1mnw7.cloudfront.net/assets/embed.js"></script> <script async src="https://badge.dimensions.ai/badge.js"></script> <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script> <script>window.MathJax={tex:{inlineMath:[["$","$"],["\\(","\\)"]],displayMath:[["$$","$$"],["\\[","\\]"]],tags:"all",tagSide:"right",tagIndent:"0.8em",processEscapes:!0},startup:{ready:function(){console.log("MathJax is ready and configured for automatic equation numbering."),MathJax.startup.defaultReady()}}};</script> <script defer src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script> <script type="text/javascript">function progressBarSetup(){"max"in document.createElement("progress")?(initializeProgressElement(),$(document).on("scroll",function(){progressBar.attr({value:getCurrentScrollPosition()})}),$(window).on("resize",initializeProgressElement)):(resizeProgressBar(),$(document).on("scroll",resizeProgressBar),$(window).on("resize",resizeProgressBar))}function getCurrentScrollPosition(){return $(window).scrollTop()}function initializeProgressElement(){let e=$("#navbar").outerHeight(!0);$("body").css({"padding-top":e}),$("progress-container").css({"padding-top":e}),progressBar.css({top:e}),progressBar.attr({max:getDistanceToScroll(),value:getCurrentScrollPosition()})}function getDistanceToScroll(){return $(document).height()-$(window).height()}function resizeProgressBar(){progressBar.css({width:getWidthPercentage()+"%"})}function getWidthPercentage(){return getCurrentScrollPosition()/getDistanceToScroll()*100}const progressBar=$("#progress");window.onload=function(){setTimeout(progressBarSetup,50)};</script> </body> </html>