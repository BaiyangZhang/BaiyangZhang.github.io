<!DOCTYPE html> <html lang="en"> <head> <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title>Gradient Method for q-Sigmoid Loss Function | Baiyang Zhang</title> <meta name="author" content="Baiyang 张柏阳 Zhang"> <meta name="description" content="A place dedicated to sharing insights and reflections on mathematics, physics, and social sciences. "> <meta name="keywords" content="mathematics, physics, academic-website, portfolio-website"> <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script> <script>window.MathJax={tex:{inlineMath:[["$","$"],["\\(","\\)"]],displayMath:[["$$","$$"],["\\[","\\]"]],tags:"all",tagSide:"right",tagIndent:"0.8em",processEscapes:!0},startup:{ready:function(){console.log("MathJax is ready and configured for automatic equation numbering."),MathJax.startup.defaultReady()}}};</script> <script defer src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script> <link rel="stylesheet" href="/assets/css/bootstrap.min.css?a4b3f509e79c54a512b890d73235ef04"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous"> <link defer rel="stylesheet" href="https://unpkg.com/bootstrap-table@1.22.1/dist/bootstrap-table.min.css"> <link rel="stylesheet" href="/assets/css/academicons.min.css?f0b7046b84e425c55f3463ac249818f5"> <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons"> <link rel="stylesheet" href="/assets/css/jekyll-pygments-themes-github.css?19f3075a2d19613090fe9e16b564e1fe" media="" id="highlight_theme_light"> <link rel="shortcut icon" href="/assets/img/z.png?010ffa0c9cb27051b15dc9ea045f2023"> <link rel="stylesheet" href="/assets/css/main.css?d41d8cd98f00b204e9800998ecf8427e"> <link rel="canonical" href="https://baiyangzhang.github.io/blog/2025/Gradient-Method-for-q-Sigmoid-Loss-Function/"> <link rel="stylesheet" href="/assets/css/jekyll-pygments-themes-native.css?e74e74bf055e5729d44a7d031a5ca6a5" media="none" id="highlight_theme_dark"> <script src="/assets/js/theme.js?96d6b3e1c3604aca8b6134c7afdd5db6"></script> <script src="/assets/js/dark_mode.js?9b17307bb950ffa2e34be0227f53558f"></script> </head> <body class="fixed-top-nav "> <header> <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top"> <div class="container"> <a class="navbar-brand title font-weight-lighter" href="/">Baiyang Zhang</a> <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar top-bar"></span> <span class="icon-bar middle-bar"></span> <span class="icon-bar bottom-bar"></span> </button> <div class="collapse navbar-collapse text-right" id="navbarNav"> <ul class="navbar-nav ml-auto flex-nowrap"> <li class="nav-item "> <a class="nav-link" href="/">about</a> </li> <li class="nav-item active"> <a class="nav-link" href="/blog/">blogs<span class="sr-only">(current)</span></a> </li> <li class="nav-item "> <a class="nav-link" href="/publications/">publications</a> </li> <li class="nav-item "> <a class="nav-link" href="/cv/">cv</a> </li> <li class="nav-item "> <a class="nav-link" href="/teaching/">teaching</a> </li> <li class="toggle-container"> <button id="light-toggle" title="Change theme"> <i class="fas fa-moon"></i> <i class="fas fa-sun"></i> </button> </li> </ul> </div> </div> </nav> <progress id="progress" value="0"> <div class="progress-container"> <span class="progress-bar"></span> </div> </progress> </header> <div class="container mt-5"> <div class="post"> <header class="post-header"> <h1 class="post-title">Gradient Method for q-Sigmoid Loss Function</h1> <p class="post-meta">September 22, 2025• Baiyang Zhang</p> <p class="post-tags"> <a href="/blog/2025"> <i class="fas fa-calendar fa-sm"></i> 2025 </a>   ·   <a href="/blog/tag/tsallis"> <i class="fas fa-hashtag fa-sm"></i> tsallis</a>   </p> </header> <article class="post-content"> <div id="markdown-content"> <h2 id="q-log-and-q-exp">q-log and q-exp</h2> <p>The definition of Tsallis-modified log and exponential functions, so-called $q$-log and $q$-exponentials, for future convenience:</p> \[\begin{align*} \log_ {q} (x) := &amp; \frac{x^{1-q}-1}{1-q}, \\ \exp_ {q}(x) :=&amp; (1+(1-q)x)^{1/(1-q)}_ {+}. \end{align*}\] <p>Note that in the exponential function, if $1+(1-q)x&lt;0$ then $(1+(1-q)x)_ {+}=0$ by definition, in this case if $\frac{1}{1-q}&lt;0$, then we have zero to the power of some negative number, namely $0^{\alpha}$ where $\alpha&lt;0$. This is to be interpreted as $\frac{1}{0^{\left\lvert \alpha \right\rvert}}=\frac{1}{0 }\approx \infty$. The purpose of this particular definition is to make sure that $\exp_ {q}$ has the same asymptotic behavior as the regular exponential function.</p> <p>As you can check, at the limit $q\to 1$ they regress to normal log and exp functions.</p> <p>For computational convenience, we will stick with the <strong>q-sigmoid of the first kind</strong>, which is the direct deformation of the regular sigmoid function</p> \[\sigma(z) = \frac{1}{1+e^{ -z }}.\] <p>As a result we have the $q$-sigmoid of the first kind:</p> \[\boxed{ \sigma_ {q}(z) := \frac{1}{1+\exp_ {q}(-z)}. }\] \[\frac{ \partial \sigma_ {q}(z) }{ \partial z } = \beta(q,z)\sigma_ {q}(z)(1-\sigma_ {q}(z))\] <p>where</p> \[\beta(q,z) = \frac{1}{1-z(1-q)}.\] <p>This should be compared to the case of regular sigmoid function:</p> <p>\(\frac{ \partial \sigma(z) }{ \partial z } = \sigma(z) (1-\sigma(z)).\) The cross entropy loss function now reads</p> \[\boxed{ L= - \sum_ {i=1}^{n}[y_ {i}\ln(\sigma _ {q_ {i} }(z_ {i} ))+(1-y_ {i})\ln(1-\sigma_ {q_ {i} }(z_ {i} ))]. }\] <p>where $z_ {i}=\theta\cdot X^{(i)}$, $X^{(i)}$ the $i$-th observed data and the q-parameters $q_ {i}$ are different for each sample. Someone write it as $z_ {i}=\theta^{T}X^{(i)}$, but I neglect the transpose symbol since now both $\theta$ and $X$ are understood as vectors. For starters we can set all the $q_ {i}$ as the same constant for all samples, do a grid search over certain intervals, such as from 0 to 10 or something. This will greatly reduce the number of free parameters hence prevents over fitting.</p> <p>We will use the gradient method to find the optimal values of parameters that minimized the loss function. Next we work out the derivative of loss function.</p> <p>Some straightforward derivation shows that</p> \[\frac{ \partial L(y,\sigma_ {q}(z)) }{ \partial z_ {i} } = \beta_ {q}(z_ {i} )(\sigma_ {q}(z_ {i} )-y_ {i} ),\] <p>where $\beta_ {q}(z) = \frac{1}{1-z(1-q)}$. The derivative of the loss function with respect to parameters can be readily written as</p> \[\boxed{ \frac{ \partial L(y,\theta) }{ \partial \theta ^{a} } = \sum_ {i} \beta_ {q}(z) (\sigma_ {q}(z_ {i} )-y_ {i})X^{(i)}_ {a}, \quad z_ {i} =\sum_ {a}\theta^{a} \cdot X^{(i)}_ {a} = \theta \cdot X^{(i)}. }\] <p>Note that I have replace $q_ {i}$ with an universal $q$. In contrast to the classical result, there is an extra $\beta$ factor which is nonlinear in both $q$ and $z$.</p> <h2 id="deformation-hyperparameter">Deformation (hyper)parameter</h2> <p>the expressions are greatly simplified if we define the <code class="language-plaintext highlighter-rouge">deformation hyperparameter</code> $\eta:=1-q$, $\eta \in\mathbb{R}^\ast$ where $\mathbb{R}^\ast:=\mathbb{R}\backslash \left\lbrace 0 \right\rbrace$ is the punctured real line. The deformed exponential functions in terms of $\eta$ reads</p> \[\exp_ {\delta}(x) = (1+\eta x)^{1/\eta}_ {+}.\] <p>The derivative of $\exp {\eta}(z)$ with respect to $\eta$ is</p> \[\frac{ \partial \exp_ {\eta}(z) }{ \partial \eta } = \begin{cases} \exp_ {\eta}(z) \left( \frac{z}{\eta(1+\eta z)}- \frac{1}{\eta^{2}}\ln(1+\eta z) \right), &amp; 1+\eta x&gt;0, \\ 0, &amp; \text{otherwise}. \end{cases}\] <p>Denote</p> \[\gamma(z; \eta):= \frac{z}{\eta(1+\eta z)}-\frac{1}{\eta^{2}}\ln(1+\eta z),\] <p>then for $1+\eta x&gt;0$ we have</p> \[\frac{ \partial \exp _ {\eta}(z) }{ \partial \eta } =\exp_ {\eta}(z) \gamma(z;\eta).\] <p>The deformed sigmoid function, now addressed to as $\eta$-sigmoid, reads</p> \[\sigma_ {\eta}(z) := \frac{1}{1+\exp_ {\eta}(-z)},\] <p>whose derivative with respect to $\eta$ is</p> \[\frac{ \partial \sigma_ {\eta}(z) }{ \partial \eta } = \sigma_ {\eta}(z)(1-\sigma_ {\eta}(z))\gamma(-z;\eta).\] <p><strong>The gradient of loss function with respect to the deformation parameter</strong> reads</p> \[\boxed{\frac{ \partial L(y,\sigma_ {q}(z)) }{ \partial \eta } =\sum_ {i\in G} \gamma(-z_ {i};\eta) (y_ {i} -\sigma_ {\eta}(z_ {i} )),}\] <p>where $G$ in $i\in G$ means that the regression is done within a certain group of shared clinical covariates, such as age, sex, etc. Note that the deformation parameter $\eta$ depends on the $G$ chose.</p> <h1 id="appendix-useful-mathematical-formulae">Appendix. Useful Mathematical Formulae</h1> <p>The definition of $q$-logarithm and $q$-exponential, $x&gt;0, q \in\mathbb{R}$:</p> \[\begin{align*} \ln_ {q}x &amp;:= \frac{x^{1-q}-1}{1-q}, \\ e^{ x }_ {q} &amp;:= (1+(1-q)x)^{1/(1-q)},\quad 0 \text{ if } 1+(1-q)x&lt;0. \end{align*}\] <p>Note that in the definition of the exponential it is required that $1+(1-q)x&gt;0$, otherwise it is defined to be zero. This is to make sure the the value of $e_ {q}$ is positive definite. It is easily checked that $\log <em>q$ and $\exp</em> {q}$ are indeed inverse to each other.</p> <p>many formula for $q$-logarithms reminds us of that for the regular $q$-logarithms.</p> \[\begin{align*} \ln_ {q}(xy) &amp;= \ln_ {q}(x)+ \ln_ {q}(y) + (1-q)\ln_ {q}(x)\ln_ {q}(x) , \\ \ln_ {q}(1+x) &amp;= \sum_ {1}^{\infty} (-1)^{n-1} \frac{(q)_ {n}}{n!} x^{n}, \\ (q)_ {n} &amp;= \frac{\Gamma(q+k)}{\Gamma(q)} = q(q+1)\cdots(q+k-1), \\ \ln_ {q}\prod_ {k=1}^{n}x_ {k} &amp;= \sum_ {k=1}^{n} (1-q)^{k-1}\sum_ {i_ {k} &gt;\cdots&gt;i_ {1}=1}^{n} \ln_ {q}x_ {i_ {1}}\cdots\ln_ {q}x_ {i_ {k}}. \end{align*}\] <p>We also have</p> \[\begin{align*} \ln_ {q} x &amp;= x^{1-q}\ln_ {2-q}x , \\ q \ln_ {1-q}x^{a} &amp;= a \ln_ {1-a} x^{q} . \end{align*}\] <p>Regarding the $q$-exponentials,</p> \[\begin{align*} \left( e_ {q}^{f(x)} \right) ^{a} &amp;= e^{ af(x) }_ {1-(1-q)/a},\\ \frac{d}{dx} e_ {q}^{f(x)} &amp;= (e_ {q}^{f(x)})^{q} \times f'(x) \end{align*}\] <p>For more details, refer to the textbook by Tsallis himself and <a href="https://doi.org/10.1016/S0378-4371(01)00567-2" title="Persistent link using digital object identifier" rel="external nofollow noopener" target="_blank">https://doi.org/10.1016/S0378-4371(01)00567-2</a>.</p> </div> </article> <br> <hr> <br> <ul class="list-disc pl-8"></ul> <h2 class="text-3xl font-semibold mb-4 mt-12">Enjoy Reading This Article?</h2> <p class="mb-2">Here are some more articles you might like to read next:</p> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/blog/2022/displaying-external-posts-on-your-al-folio-blog/">Displaying External Posts on Your al-folio Blog</a> </li> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/blog/2025/Does-Adiabatic-Assumption-Work/">Does Adiabatic Assumption Work?</a> </li> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/blog/2025/Mathematical-Note-of-Quantum-Physics/">Mathematical Note of Quantum Physics</a> </li> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/blog/2025/Note-on-The-Moral-Foundations-of-Politics/">Note on The Moral Foundations of Politics by Ian Shapiro</a> </li> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/blog/2025/Abelian-Decomposition-and-Monopole/">Bare Minimum of Abelian Decomposition and Monopole</a> </li> </div> </div> <footer class="fixed-bottom"> <div class="container mt-0"> © Copyright 2025 Baiyang 张柏阳 Zhang. Powered by <a href="https://jekyllrb.com/" target="_blank" rel="external nofollow noopener">Jekyll</a> with <a href="https://github.com/alshedivat/al-folio" rel="external nofollow noopener" target="_blank">al-folio</a> theme. Hosted by <a href="https://pages.github.com/" target="_blank" rel="external nofollow noopener">GitHub Pages</a>. Last updated: September 22, 2025. </div> </footer> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> <script src="/assets/js/bootstrap.bundle.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/masonry-layout@4.2.2/dist/masonry.pkgd.min.js" integrity="sha256-Nn1q/fx0H7SNLZMQ5Hw5JLaTRZp0yILA/FRexe19VdI=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/imagesloaded@4/imagesloaded.pkgd.min.js"></script> <script defer src="/assets/js/masonry.js" type="text/javascript"></script> <script defer src="https://cdn.jsdelivr.net/npm/medium-zoom@1.0.8/dist/medium-zoom.min.js" integrity="sha256-7PhEpEWEW0XXQ0k6kQrPKwuoIomz8R8IYyuU1Qew4P8=" crossorigin="anonymous"></script> <script defer src="/assets/js/zoom.js?7b30caa5023af4af8408a472dc4e1ebb"></script> <script defer src="https://unpkg.com/bootstrap-table@1.22.1/dist/bootstrap-table.min.js"></script> <script src="/assets/js/no_defer.js?d633890033921b33e0ceb13d22340a9c"></script> <script defer src="/assets/js/common.js?acdb9690d7641b2f8d40529018c71a01"></script> <script defer src="/assets/js/copy_code.js?c9d9dd48933de3831b3ee5ec9c209cac" type="text/javascript"></script> <script async src="https://d1bxh8uas1mnw7.cloudfront.net/assets/embed.js"></script> <script async src="https://badge.dimensions.ai/badge.js"></script> <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script> <script>window.MathJax={tex:{inlineMath:[["$","$"],["\\(","\\)"]],displayMath:[["$$","$$"],["\\[","\\]"]],tags:"all",tagSide:"right",tagIndent:"0.8em",processEscapes:!0},startup:{ready:function(){console.log("MathJax is ready and configured for automatic equation numbering."),MathJax.startup.defaultReady()}}};</script> <script defer src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script> <script type="text/javascript">function progressBarSetup(){"max"in document.createElement("progress")?(initializeProgressElement(),$(document).on("scroll",function(){progressBar.attr({value:getCurrentScrollPosition()})}),$(window).on("resize",initializeProgressElement)):(resizeProgressBar(),$(document).on("scroll",resizeProgressBar),$(window).on("resize",resizeProgressBar))}function getCurrentScrollPosition(){return $(window).scrollTop()}function initializeProgressElement(){let e=$("#navbar").outerHeight(!0);$("body").css({"padding-top":e}),$("progress-container").css({"padding-top":e}),progressBar.css({top:e}),progressBar.attr({max:getDistanceToScroll(),value:getCurrentScrollPosition()})}function getDistanceToScroll(){return $(document).height()-$(window).height()}function resizeProgressBar(){progressBar.css({width:getWidthPercentage()+"%"})}function getWidthPercentage(){return getCurrentScrollPosition()/getDistanceToScroll()*100}const progressBar=$("#progress");window.onload=function(){setTimeout(progressBarSetup,50)};</script> </body> </html>